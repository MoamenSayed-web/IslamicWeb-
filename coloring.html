<!doctype html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#2c3e50" />
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© | Ø³Ø±Ø§Ø¬ Ù„Ù„Ø£Ø·ÙØ§Ù„</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@400;600;700&family=Reem+Kufi:wght@400;600;700&family=Tajawal:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <!-- FontAwesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Main CSS -->
    <link rel="stylesheet" href="css/style.css" />
    <style>
      body {
        /* Kids friendly background */
        background-color: #f7fbff;
        background-image: url("data:image/svg+xml,%3Csvg width='52' height='26' viewBox='0 0 52 26' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%2363b3ed' fill-opacity='0.1'%3E%3Cpath d='M10 10c0-2.21-1.79-4-4-4-3.314 0-6-2.686-6-6h2c0 2.21 1.79 4 4 4 3.314 0 6 2.686 6 6 0 2.21 1.79 4 4 4 3.314 0 6 2.686 6 6 0 2.21 1.79 4 4 4v2c-3.314 0-6-2.686-6-6 0-2.21-1.79-4-4-4-3.314 0-6-2.686-6-6v-2c3.314 0 6 2.686 6 6zM82 10c0-2.21-1.79-4-4-4-3.314 0-6-2.686-6-6h2c0 2.21 1.79 4 4 4 3.314 0 6 2.686 6 6 0 2.21 1.79 4 4 4 3.314 0 6 2.686 6 6 0 2.21 1.79 4 4 4v2c-3.314 0-6-2.686-6-6 0-2.21-1.79-4-4-4-3.314 0-6-2.686-6-6v-2c3.314 0 6 2.686 6 6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      }
      [data-theme="dark"] body {
        background-color: var(--bg-color);
      }
      .coloring-header {
        text-align: center;
        padding: 100px 20px 40px;
        background: linear-gradient(
          135deg,
          #ff9a9e 0%,
          #fecfef 99%,
          #fecfef 100%
        );
        color: #fff;
        border-bottom-left-radius: 50% 20px;
        border-bottom-right-radius: 50% 20px;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        margin-bottom: 40px;
      }
      [data-theme="dark"] .coloring-header {
        background: linear-gradient(135deg, #8b5a83 0%, #4d3d5e 100%);
      }
      .coloring-header h1 {
        font-family: var(--font-reem);
        font-size: 3rem;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        color: white;
      }

      .coloring-app {
        max-width: 1000px;
        margin: 0 auto 60px;
        background: var(--bg-secondary);
        border-radius: 20px;
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        border: 4px solid #ffd166;
        overflow: hidden;
      }

      .toolbar {
        background: #f8f9fa;
        padding: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 15px;
        border-bottom: 2px solid #eee;
      }
      [data-theme="dark"] .toolbar {
        background: var(--bg-tertiary);
        border-color: var(--border-color);
      }

      .colors-palette {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }
      .color-btn {
        width: 35px;
        height: 35px;
        border-radius: 50%;
        border: 3px solid #fff;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        transition: transform 0.2s;
      }
      .color-btn:hover,
      .color-btn.active {
        transform: scale(1.2);
        border-color: #333;
      }

      .tools {
        display: flex;
        gap: 10px;
      }
      .tool-btn {
        width: 45px;
        height: 45px;
        border-radius: 10px;
        border: none;
        background: white;
        color: #333;
        font-size: 1.2rem;
        cursor: pointer;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        transition: all 0.2s;
      }
      [data-theme="dark"] .tool-btn {
        background: var(--bg-color);
        color: var(--text-main);
      }
      .tool-btn.active,
      .tool-btn:hover {
        background: #ffd166;
        color: #000;
        transform: translateY(-2px);
      }

      .brush-size {
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: bold;
      }

      .canvas-container {
        position: relative;
        width: 100%;
        height: 500px;
        background: #fff;
        cursor: crosshair;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      #drawing-canvas {
        position: absolute;
        top: 0;
        left: 0;
        z-index: 2;
      }

      #bg-image {
        position: absolute;
        max-width: 90%;
        max-height: 90%;
        object-fit: contain;
        opacity: 0.2; /* Light outline to color over */
        z-index: 1;
        pointer-events: none;
      }

      .templates {
        display: flex;
        gap: 15px;
        padding: 20px;
        background: #fffcf5;
        overflow-x: auto;
        border-top: 2px dashed #eee;
      }
      [data-theme="dark"] .templates {
        background: var(--bg-secondary);
        border-color: var(--border-color);
      }

      .template-img {
        width: 100px;
        height: 100px;
        object-fit: contain;
        border: 2px solid #ddd;
        border-radius: 10px;
        cursor: pointer;
        background: white;
        transition: transform 0.2s;
      }
      .template-img:hover {
        transform: scale(1.05);
        border-color: #ffd166;
      }

      .canvas-actions {
        padding: 15px;
        display: flex;
        justify-content: center;
        gap: 15px;
        background: #f8f9fa;
      }
      [data-theme="dark"] .canvas-actions {
        background: var(--bg-tertiary);
      }
      .canvas-actions .btn {
        border-radius: 20px;
        font-size: 1rem;
        padding: 10px 25px;
      }
    </style>
  </head>

  <body>
            <!-- Header/Navbar -->
        <!-- Header/Navbar -->
    <header class="main-header">
      <nav class="navbar">
        <div class="container nav-content">
          <a href="index.html" class="logo">
            <i class="fa-solid fa-moon"></i> Ø³Ø±Ø§Ø¬
          </a>
          <ul class="nav-links">
            <li><a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
            <li><a href="quran.html">Ø§Ù„Ù‚Ø±Ø¢Ù†</a></li>
            <li><a href="hadith.html">Ø§Ù„Ø­Ø¯ÙŠØ«</a></li>
            <li><a href="azkar.html">Ø§Ù„Ø£Ø°ÙƒØ§Ø±</a></li>
            <li><a href="prayer-times.html">Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø©</a></li>
            <li><a href="library.html">Ø§Ù„Ù…ÙƒØªØ¨Ø©</a></li>
          </ul>
          <div class="nav-actions">
            <button id="theme-toggle" aria-label="Toggle theme">
              <i class="fa-solid fa-cloud-sun"></i>
            </button>
            <div class="menu-toggle">
              <i class="fa-solid fa-bars"></i>
            </div>
          </div>
        </div>
      </nav>
      <nav class="sub-navbar">
        <div class="container sub-nav-content">
          <ul class="sub-nav-links">
            <li><a href="tafseer.html">Ø§Ù„ØªÙØ³ÙŠØ±</a></li>
            <li><a href="fatwa.html">Ø§Ù„ÙØªØ§ÙˆÙ‰</a></li>
            <li><a href="cards.html">Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª</a></li>
            <li><a href="qibla.html">Ø§Ù„Ù‚Ø¨Ù„Ø©</a></li>
            <li><a href="zakat.html">Ø§Ù„Ø²ÙƒØ§Ø©</a></li>
            <li><a href="names.html">Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„Ù‡</a></li>
            <li><a href="prayer-tracker.html">Ù…ØªØªØ¨Ø¹ Ø§Ù„ØµÙ„ÙˆØ§Øª</a></li>
            <li><a href="khatma.html">Ø§Ù„Ø®ØªÙ…Ø©</a></li>
            <li><a href="hajj.html">Ø§Ù„Ø­Ø¬</a></li>
            <li><a href="tasbeeh.html">Ø§Ù„Ù…Ø³Ø¨Ø­Ø©</a></li>
            <li><a href="radio.html">Ø§Ù„Ø±Ø§Ø¯ÙŠÙˆ</a></li>
            <li><a href="live.html">Ù…Ø¨Ø§Ø´Ø±</a></li>
            <li><a href="calendar.html">Ø§Ù„ØªÙ‚ÙˆÙŠÙ…</a></li>
            <li><a href="kids.html">Ø§Ù„Ø£Ø·ÙØ§Ù„</a></li>
            <li><a href="stories.html">Ø§Ù„Ù‚ØµØµ</a></li>
            <li><a href="coloring.html" class="active">Ø§Ù„ØªÙ„ÙˆÙŠÙ†</a></li>
          </ul>
        </div>
      </nav>
    </header>

    <div class="coloring-header">
      <h1 class="fade-in-up">Ù„ÙˆØ­Ø© Ø§Ù„ØªÙ„ÙˆÙŠÙ† Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ© ðŸŽ¨</h1>
      <p class="fade-in-up delay-1">
        Ø§Ø®ØªØ± ØµÙˆØ±Ø© ÙˆÙ„ÙˆÙ†Ù‡Ø§ Ø¨Ø£Ø¬Ù…Ù„ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ù„ØªØµÙ†Ø¹ Ù„ÙˆØ­ØªÙƒ Ø§Ù„ÙÙ†ÙŠØ©!
      </p>
    </div>

    <div class="container">
      <div class="coloring-app reveal active">
        <div class="toolbar">
          <div class="colors-palette" id="colors-palette">
            <!-- Colors generate via JS -->
          </div>

          <div class="tools">
            <button class="tool-btn active" id="tool-brush" title="ÙØ±Ø´Ø§Ø©">
              <i class="fa-solid fa-paint-brush"></i>
            </button>
            <button class="tool-btn" id="tool-eraser" title="Ù…Ù…Ø­Ø§Ø©">
              <i class="fa-solid fa-eraser"></i>
            </button>
          </div>

          <div class="brush-size">
            <i class="fa-solid fa-circle" style="font-size: 8px"></i>
            <input type="range" id="brush-size" min="2" max="50" value="10" />
            <i class="fa-solid fa-circle" style="font-size: 20px"></i>
          </div>
        </div>

        <div class="canvas-container" id="canvas-container">
          <!-- We use SVG vectors as placeholders for the kids to color over -->
          <img
            id="bg-image"
            src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50 10 L80 40 L80 90 L20 90 L20 40 Z" fill="none" stroke="black" stroke-width="2"/><rect x="40" y="60" width="20" height="30" fill="none" stroke="black" stroke-width="2"/><circle x="50" y="30" r="5" fill="none" stroke="black" stroke-width="2"/></svg>'
            alt="Template"
          />
          <canvas id="drawing-canvas"></canvas>
        </div>

        <div class="templates">
          <img
            class="template-img"
            src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50 10 L80 40 L80 90 L20 90 L20 40 Z" fill="none" stroke="black" stroke-width="2"/><rect x="40" y="60" width="20" height="30" fill="none" stroke="black" stroke-width="2"/></svg>'
            onclick="changeTemplate(this.src)"
            alt="Mosque"
          />
          <img
            class="template-img"
            src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect x="30" y="30" width="40" height="40" fill="none" stroke="black" stroke-width="2"/><path d="M30 30 L70 70 M70 30 L30 70" stroke="black" stroke-width="2"/></svg>'
            onclick="changeTemplate(this.src)"
            alt="Kaaba"
          />
          <img
            class="template-img"
            src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50 20 C60 20 70 30 70 50 C70 70 50 80 50 80 C50 80 30 70 30 50 C30 30 40 20 50 20 Z" fill="none" stroke="black" stroke-width="2"/></svg>'
            onclick="changeTemplate(this.src)"
            alt="Lantern"
          />
        </div>

        <div class="canvas-actions">
          <button
            class="btn btn-primary"
            id="clear-btn"
            style="background-color: #e74c3c"
          >
            <i class="fa-solid fa-trash-can"></i> Ù…Ø³Ø­ Ø§Ù„Ù„ÙˆØ­Ø©
          </button>
          <button
            class="btn btn-primary"
            id="save-btn"
            style="background-color: #2ecc71"
          >
            <i class="fa-solid fa-download"></i> Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©
          </button>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="container footer-content">
        <div class="footer-brand">
          <a href="index.html" class="logo"
            ><i class="fa-solid fa-moon"></i> Ø³Ø±Ø§Ø¬</a
          >
        </div>
      </div>
      <div class="footer-bottom">
        <p>
          Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© &copy; <span id="current-year"></span> Ø³Ø±Ø§Ø¬
          Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©.
        </p>
      </div>
    </footer>

    <script src="js/main.js"></script>
    <script>
      const canvas = document.getElementById("drawing-canvas");
      const ctx = canvas.getContext("2d");
      const container = document.getElementById("canvas-container");

      let isDrawing = false;
      let currentColor = "#ef476f";
      let currentSize = 10;
      let currentTool = "brush"; // 'brush' or 'eraser'

      // Set canvas size to match container
      function resizeCanvas() {
        canvas.width = container.offsetWidth;
        canvas.height = container.offsetHeight;
        // Re-apply settings after resize
        ctx.lineCap = "round";
        ctx.lineJoin = "round";
      }

      window.addEventListener("resize", resizeCanvas);
      resizeCanvas();

      // Colors setup
      const colors = [
        "#ef476f",
        "#f78c6b",
        "#ffd166",
        "#06d6a0",
        "#118ab2",
        "#073b4c",
        "#9b5de5",
        "#000000",
        "#ffffff",
      ];
      const palette = document.getElementById("colors-palette");

      colors.forEach((color) => {
        const btn = document.createElement("div");
        btn.className = "color-btn";
        btn.style.backgroundColor = color;
        if (color === currentColor) btn.classList.add("active");

        btn.onclick = () => {
          document
            .querySelectorAll(".color-btn")
            .forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");
          currentColor = color;
          setTool("brush");
        };
        palette.appendChild(btn);
      });

      // Tools Setup
      const brushBtn = document.getElementById("tool-brush");
      const eraserBtn = document.getElementById("tool-eraser");
      const sizeInput = document.getElementById("brush-size");

      function setTool(tool) {
        currentTool = tool;
        brushBtn.classList.toggle("active", tool === "brush");
        eraserBtn.classList.toggle("active", tool === "eraser");
      }

      brushBtn.onclick = () => setTool("brush");
      eraserBtn.onclick = () => setTool("eraser");
      sizeInput.oninput = (e) => (currentSize = e.target.value);

      // Drawing Logic
      function startPosition(e) {
        isDrawing = true;
        draw(e);
      }

      function endPosition() {
        isDrawing = false;
        ctx.beginPath();
      }

      function draw(e) {
        if (!isDrawing) return;

        // Get correct coordinates relative to canvas
        const rect = canvas.getBoundingClientRect();
        let clientX, clientY;

        if (e.type.includes("touch")) {
          clientX = e.touches[0].clientX;
          clientY = e.touches[0].clientY;
        } else {
          clientX = e.clientX;
          clientY = e.clientY;
        }

        const x = clientX - rect.left;
        const y = clientY - rect.top;

        ctx.lineWidth = currentSize;
        ctx.lineCap = "round";

        if (currentTool === "eraser") {
          ctx.globalCompositeOperation = "destination-out";
          ctx.strokeStyle = "rgba(0,0,0,1)";
        } else {
          ctx.globalCompositeOperation = "source-over";
          ctx.strokeStyle = currentColor;
        }

        ctx.lineTo(x, y);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(x, y);
      }

      // Event Listeners for drawing
      canvas.addEventListener("mousedown", startPosition);
      canvas.addEventListener("mouseup", endPosition);
      canvas.addEventListener("mousemove", draw);
      canvas.addEventListener("mouseout", endPosition);

      // Touch support
      canvas.addEventListener(
        "touchstart",
        (e) => {
          e.preventDefault();
          startPosition(e);
        },
        { passive: false },
      );
      canvas.addEventListener("touchend", endPosition);
      canvas.addEventListener(
        "touchmove",
        (e) => {
          e.preventDefault();
          draw(e);
        },
        { passive: false },
      );

      // Actions
      document.getElementById("clear-btn").onclick = () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
      };

      document.getElementById("save-btn").onclick = () => {
        // Create a temporary canvas to merge background image and drawing
        const tempCanvas = document.createElement("canvas");
        tempCanvas.width = canvas.width;
        tempCanvas.height = canvas.height;
        const tempCtx = tempCanvas.getContext("2d");

        // Fill white background
        tempCtx.fillStyle = "#ffffff";
        tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);

        // Draw image placeholder (approximate position)
        const bgImg = document.getElementById("bg-image");
        tempCtx.globalAlpha = 0.2;
        // Calculate center for image
        const imgH = tempCanvas.height * 0.9;
        const imgW = tempCanvas.width * 0.9;
        tempCtx.drawImage(
          bgImg,
          (tempCanvas.width - imgW) / 2,
          (tempCanvas.height - imgH) / 2,
          imgW,
          imgH,
        );

        // Draw user lines
        tempCtx.globalAlpha = 1.0;
        tempCtx.drawImage(canvas, 0, 0);

        const link = document.createElement("a");
        link.download = "Ù„ÙˆØ­ØªÙŠ-Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©.png";
        link.href = tempCanvas.toDataURL();
        link.click();
      };

      // Change Template
      window.changeTemplate = function (src) {
        document.getElementById("bg-image").src = src;
      };
    </script>
  </body>
</html>

